# Скрипт PowerShell для управления службами 1С:Предприятия 8.3 с GUI

Данный скрипт позволяет создавать, запускать и останавливать службы 1С:Предприятия 8.3 с помощью удобного графического интерфейса Windows Forms. В нём реализованы дополнительные возможности и логирование, а также автоматическое создание конфигурационных папок.

---

## Основные возможности

- **Выбор пути к платформе 1С**: укажите папку с платформой, где расположены `ragent.exe` и `ras.exe`.
- **Выбор верхнеуровневой папки для конфигурации srvinfo**: скрипт автоматически создаст папку `srvinfo<порт>41` в указанном месте.
- **Настройка стартового порта** для служб.
- **Дополнительные приписки к DisplayName** для служб агента (`ragent`) и удалённого сервера (`ras`).
- **Автоматическое создание и удаление служб** с заданными параметрами.
- **Логирование всех действий** в выделенном окне в реальном времени.
- **Обработка учетных данных** пользователя для служб.
- **Копирование и модификация конфигурационных файлов `.lst`** с добавлением временных резервных копий и заменой имени компьютера на полное доменное имя (FQDN).
- **Плавное смена фона GUI недоступна в текущей версии (по требованию пользователя можно реализовать).**

---

## Требования

- Запуск с правами администратора.
- Windows PowerShell с поддержкой Windows Forms (обычно PowerShell 5.x на Windows).
- Папка платформы должна содержать исполняемые файлы:
  - `bin\ragent.exe`
  - `bin\ras.exe`
- Доступ к управлению службами Windows.

---

## Использование

1. Запустите скрипт через PowerShell **с правами администратора**.  
   Скрипт автоматически перезапустится с повышенными правами, если запущен без них.

2. В графическом окне укажите:
   - Путь к платформе 1С.
   - Верхнеуровневую папку для создания/использования `srvinfo`.
   - Номер стартового порта (обычно `29`).
   - Приписки к DisplayName для служб `ragent` и `ras` (опционально).

3. Нажмите кнопку **Выполнить**.

4. Следите за логом операций в нижней части окна.

---

## Основные элементы интерфейса

| Элемент                 | Описание                                      |
|------------------------|-----------------------------------------------|
| Папка с платформой      | Путь к корню платформы 1С                      |
| Верхнеуровневая папка   | Путь, где создается конфигурационная папка `srvinfo...` |
| Стартовый порт          | Начальный порт для служб 1С                     |
| Приписка к DisplayName ragent | Суффикс для имени службы агента сервера 1С     |
| Приписка к DisplayName ras    | Суффикс для имени службы удалённого сервера 1С    |
| Кнопка Выполнить        | Запуск процесса создания/запуска служб и конфигурации |
| Окно логирования        | Отображение действий, ошибок и статусов         |

---

## Логирование

- Все основные операции логируются с отметкой времени.
- Выводятся сообщения об успехах, ошибках, ходе выполнения.
- Лог помогает отследить процесс и выявить проблемы.

---

## Предупреждения и рекомендации

- Обязательно запускать с правами администратора, иначе скрипт завершится с просьбой перезапуска.
- Внимательно проверяйте пути к платформе и правам на записи в папку `srvinfo`.
- Для корректного создания служб учетные данные должны быть действующими.
- Не закрывайте окно во время работы — скрипт выполняет множество сложных операций.

---

## Лицензия и поддержка

Скрипт предоставляется "как есть", без гарантий и поддержки. Для вопросов и доработок обращайтесь к автору.

---

Спасибо за использование скрипта!
